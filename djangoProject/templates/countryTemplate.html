{% load static %}
<!DOCTYPE html>
<html lang="mk">
<head>
  <meta charset="UTF-8">
  <title>{{ country.name }} ‚Äì –ú–∏–Ω–∏ –ö–≤–∏–∑</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Comic+Sans+MS&display=swap" rel="stylesheet">
</head>
<body style="
  font-family: 'Comic Sans MS', sans-serif;
  background-image: url('{{ country.background.url }}');
  background-repeat: repeat-y;
  background-size: cover;
  background-color: #fff;
  color: {{ country.color }};
  padding: 20px;
">

<div class="container text-center">
  <h1 class="fw-bold py-3 px-4 rounded-4 shadow bg-white d-inline-block" style="color: {{ country.color }};">
    {{ country.headline }}
  </h1>
</div>

<form id="quizForm" class="mt-4 container">

  {% for question in questions %}
  <div class="card my-4 border-3 border-light-subtle shadow-sm rounded-4">
    <div class="card-body">
      <h5 class="card-title mb-3" style="color: {{ country.color }};">{{ forloop.counter }}. {{ question.content }}</h5>
      {% for choice in question.choice_set.all %}
        <div class="form-check text-start">
          <input class="form-check-input" type="radio" name="q{{ forloop.parentloop.counter }}" value="{{ choice.is_correct|yesno:'1,0' }}" id="q{{ forloop.parentloop.counter }}-{{ forloop.counter }}">
          <label class="form-check-label" for="q{{ forloop.parentloop.counter }}-{{ forloop.counter }}">
            {{ choice.content }}
          </label>
        </div>
      {% endfor %}
    </div>
  </div>
  {% endfor %}

  <div class="text-center">
    <button type="button" class="btn btn-lg" style="background-color: #ffc6d8; color: #800040;" onclick="calculateScore()">–ó–∞–≤—Ä—à–∏</button>
  </div>

</form>

<div id="result-box" class="alert alert-warning text-center mt-4 d-none" role="alert"></div>

<div class="container text-center mt-5">
  <a href="https://read.bookcreator.com/" target="_blank" class="btn btn-warning">‚¨ÖÔ∏è –í—Ä–∞—Ç–∏ —Å–µ –Ω–∞ –ø—Ä–∏–∫–∞–∑–Ω–∞—Ç–∞</a>
</div>

<div class="container mt-5">
  <h3 class="text-center mb-4" style="color: {{ country.color }};">üì∏ –ì–∞–ª–µ—Ä–∏—ò–∞</h3>

  <div class="d-flex flex-wrap justify-content-center gap-3" style="margin-top: 40px;">
    {% for photo in polaroids %}
      <div style="
        background-color: white;
        padding: 10px;
        border: 2px solid #ccc;
        border-radius: 12px;
        width: 140px;
        text-align: center;
        box-shadow: 2px 2px 10px rgba(0,0,0,0.1);
        transform: rotate(-2deg);
        transition: transform 0.3s ease;
      " onmouseover="this.style.transform='rotate(0deg) scale(1.05)'" onmouseout="this.style.transform='rotate(-2deg)'">
        <img src="{{ photo.photo.url }}" alt="{{ photo.headline }}" style="
          width: 100%;
          aspect-ratio: 1 / 1;
          object-fit: cover;
          display: block;
          border-radius: 6px;
        ">
        <p style="margin-top: 8px; font-size: 14px; color: #444;">{{ photo.headline }}</p>
      </div>
    {% endfor %}
  </div>
</div>



<script>
  function calculateScore() {
    let total = 0;
    const questionCount = {{ questions.count }};
    for (let i = 1; i <= questionCount; i++) {
      const selected = document.querySelector(`input[name="q${i}"]:checked`);
      if (selected) total += parseInt(selected.value);
    }

    const resultBox = document.getElementById("result-box");
    resultBox.classList.remove("d-none");
    resultBox.innerHTML =
      total >= questionCount
        ? "üéâ <strong>–ë—Ä–∞–≤–æ!</strong> –û–¥–≥–æ–≤–æ—Ä–∏ —Ç–æ—á–Ω–æ –Ω–∞ —Å–∏—Ç–µ –ø—Ä–∞—à–∞—ö–∞ ‚Äì –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ –ø–æ–∑–Ω–∞–≤–∞—ö–µ –Ω–∞ {{ country.name }}!"
        : "üå∏ <strong>–°—É–ø–µ—Ä!</strong> –ù–∞—É—á–∏ –Ω–µ—à—Ç–æ –Ω–æ–≤–æ –∏ –ø—Ä–æ–±–∞—ò –ø–∞–∫! –†–µ–∑—É–ª—Ç–∞—Ç: " + total + "/" + questionCount;
  }
</script>

</body>
</html>
